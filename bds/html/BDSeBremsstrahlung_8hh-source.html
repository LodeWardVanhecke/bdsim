<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BDS: include/BDSeBremsstrahlung.hh Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a></div>
<h1>BDSeBremsstrahlung.hh</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">//</span>
00002 <span class="comment">// ********************************************************************</span>
00003 <span class="comment">// * DISCLAIMER                                                       *</span>
00004 <span class="comment">// *                                                                  *</span>
00005 <span class="comment">// * The following disclaimer summarizes all the specific disclaimers *</span>
00006 <span class="comment">// * of contributors to this software. The specific disclaimers,which *</span>
00007 <span class="comment">// * govern, are listed with their locations in:                      *</span>
00008 <span class="comment">// *   http://cern.ch/geant4/license                                  *</span>
00009 <span class="comment">// *                                                                  *</span>
00010 <span class="comment">// * Neither the authors of this software system, nor their employing *</span>
00011 <span class="comment">// * institutes,nor the agencies providing financial support for this *</span>
00012 <span class="comment">// * work  make  any representation or  warranty, express or implied, *</span>
00013 <span class="comment">// * regarding  this  software system or assume any liability for its *</span>
00014 <span class="comment">// * use.                                                             *</span>
00015 <span class="comment">// *                                                                  *</span>
00016 <span class="comment">// * This  code  implementation is the  intellectual property  of the *</span>
00017 <span class="comment">// * GEANT4 collaboration.                                            *</span>
00018 <span class="comment">// * By copying,  distributing  or modifying the Program (or any work *</span>
00019 <span class="comment">// * based  on  the Program)  you indicate  your  acceptance of  this *</span>
00020 <span class="comment">// * statement, and all its terms.                                    *</span>
00021 <span class="comment">// ********************************************************************</span>
00022 <span class="comment">//</span>
00023 <span class="comment">//</span>
00024 <span class="comment">// $Id: BDSeBremsstrahlung.hh,v 1.1.1.1 2004/11/18 17:42:40 ilia Exp $</span>
00025 <span class="comment">// GEANT4 tag $Name:  $</span>
00026 <span class="comment">//</span>
00027 <span class="comment">// </span>
00028 <span class="comment">//      ------------ G4eBremsstrahlung physics process ------</span>
00029 <span class="comment">//                     by Laszlo Urban, 24 July 1996</span>
00030 <span class="comment">// </span>
00031 <span class="comment">// 01-10-96 new type G4OrderedTable;  ComputePartialSumSigma()</span>
00032 <span class="comment">// 20-03-97 new energy loss+ionisation+brems scheme, L.Urban</span>
00033 <span class="comment">// 01-09-98 new method  PrintInfo() </span>
00034 <span class="comment">// 10-02-00 modifications , new e.m. structure, L.Urban</span>
00035 <span class="comment">// 07-08-00 new cross section/en.loss parametrisation, LPM flag , L.Urban</span>
00036 <span class="comment">// 09-08-01 new methods Store/Retrieve PhysicsTable (mma)</span>
00037 <span class="comment">// 19-09-01 come back to previous process name "eBrem"</span>
00038 <span class="comment">// 29-10-01 all static functions no more inlined (mma)  </span>
00039 <span class="comment">// 16-01-03 Migrade to cut per region (V.Ivanchenko)</span>
00040 <span class="comment">//</span>
00041 <span class="comment">// ------------------------------------------------------------</span>
00042 
00043 <span class="comment">// Class description</span>
00044 <span class="comment">//</span>
00045 <span class="comment">// This class manages the bremsstrahlung for e-/e+</span>
00046 <span class="comment">// it inherites from G4VContinuousDiscreteProcess via G4VeEnergyLoss.</span>
00047 <span class="comment">//</span>
00048 <span class="comment">// Class description - end</span>
00049 
00050 <span class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo....</span>
00051 <span class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo....</span>
00052 
00053 <span class="preprocessor">#ifndef BDSeBremsstrahlung_h</span>
00054 <span class="preprocessor"></span><span class="preprocessor">#define BDSeBremsstrahlung_h 1</span>
00055 <span class="preprocessor"></span>
00056 <span class="preprocessor">#include "G4ios.hh"</span>
00057 <span class="preprocessor">#include "globals.hh"</span>
00058 <span class="preprocessor">#include "Randomize.hh"</span>
00059 <span class="preprocessor">#include "G4VeEnergyLoss.hh"</span>
00060 <span class="preprocessor">#include "G4Track.hh"</span>
00061 <span class="preprocessor">#include "G4Step.hh"</span>
00062 <span class="preprocessor">#include "G4Gamma.hh"</span>
00063 <span class="preprocessor">#include "G4Electron.hh"</span>
00064 <span class="preprocessor">#include "G4Positron.hh"</span>
00065 <span class="preprocessor">#include "G4OrderedTable.hh"</span>
00066 <span class="preprocessor">#include "G4PhysicsTable.hh"</span>
00067 <span class="preprocessor">#include "G4PhysicsLogVector.hh"</span>
00068 <span class="preprocessor">#include "G4MaterialCutsCouple.hh"</span>
00069 
00070 <span class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo....</span>
00071 
00072 <span class="keyword">class </span>BDSeBremsstrahlung : <span class="keyword">public</span> G4VeEnergyLoss
00073 
00074 {
00075   <span class="keyword">public</span>:
00076 
00077      BDSeBremsstrahlung(<span class="keyword">const</span> G4String&amp; processName = <span class="stringliteral">"BDSeBrem"</span>);
00078 
00079     ~BDSeBremsstrahlung();
00080 
00081      G4bool IsApplicable(<span class="keyword">const</span> G4ParticleDefinition&amp;);
00082 
00083      <span class="keywordtype">void</span> PrintInfoDefinition();
00084 
00085      <span class="keywordtype">void</span> BuildPhysicsTable(<span class="keyword">const</span> G4ParticleDefinition&amp; ParticleType);
00086 
00087      <span class="keywordtype">void</span> BuildLossTable(<span class="keyword">const</span> G4ParticleDefinition&amp; ParticleType);
00088 
00089      <span class="keywordtype">void</span> BuildLambdaTable(<span class="keyword">const</span> G4ParticleDefinition&amp; ParticleType);
00090 
00091      G4double GetMeanFreePath(<span class="keyword">const</span> G4Track&amp; track,
00092                               G4double previousStepSize,
00093                               G4ForceCondition* condition );
00094 
00095      G4VParticleChange *PostStepDoIt(<span class="keyword">const</span> G4Track&amp; track,
00096                                      <span class="keyword">const</span> G4Step&amp;  step);
00097 
00098      G4double GetLambda(G4double KineticEnergy, <span class="keyword">const</span> G4MaterialCutsCouple* couple);
00099 
00100      G4bool StorePhysicsTable(G4ParticleDefinition* ,
00101                               <span class="keyword">const</span> G4String&amp; directory, G4bool);
00102       <span class="comment">// store eLoss and MeanFreePath tables into an external file</span>
00103       <span class="comment">// specified by 'directory' (must exist before invokation)</span>
00104 
00105      G4bool RetrievePhysicsTable(G4ParticleDefinition* ,
00106                                  <span class="keyword">const</span> G4String&amp; directory, G4bool);
00107       <span class="comment">// retrieve eLoss and MeanFreePath tables from an external file</span>
00108       <span class="comment">// specified by 'directory'</span>
00109 
00110   <span class="keyword">protected</span>:
00111 
00112      G4double ComputeMeanFreePath( <span class="keyword">const</span> G4ParticleDefinition* ParticleType,
00113                                          G4double KineticEnergy,
00114                                    <span class="keyword">const</span> G4MaterialCutsCouple* couple);
00115 
00116      <span class="keywordtype">void</span> ComputePartialSumSigma( <span class="keyword">const</span> G4ParticleDefinition* ParticleType,
00117                                         G4double KineticEnergy,
00118                                   <span class="keyword">const</span> G4MaterialCutsCouple* couple);
00119 
00120      <span class="keyword">virtual</span> G4double ComputeCrossSectionPerAtom(
00121                                   <span class="keyword">const</span> G4ParticleDefinition* ParticleType,
00122                                         G4double KineticEnergy,
00123                                         G4double AtomicNumber,
00124                                         G4double GammaEnergyCut);
00125 
00126   <span class="keyword">private</span>:
00127 
00128      G4double ComputeBremLoss(G4double Z,G4double natom,G4double T,
00129                               G4double Cut,G4double x);
00130 
00131      G4double ComputePositronCorrFactorLoss(G4double AtomicNumber,
00132                                             G4double KineticEnergy,
00133                                             G4double GammaEnergyCut);
00134 
00135      G4double ComputePositronCorrFactorSigma(G4double AtomicNumber,
00136                                              G4double KineticEnergy,
00137                                              G4double GammaEnergyCut);
00138 
00139      G4Element* SelectRandomAtom(<span class="keyword">const</span> G4MaterialCutsCouple* couple) <span class="keyword">const</span>;
00140 
00141      G4double ScreenFunction1(G4double ScreenVariable);
00142 
00143      G4double ScreenFunction2(G4double ScreenVariable);
00144 
00145      G4double SupressionFunction(<span class="keyword">const</span> G4Material* aMaterial,
00146                                   G4double KineticEnergy,
00147                                   G4double GammaEnergy) ;
00148 
00149      BDSeBremsstrahlung &amp; operator=(<span class="keyword">const</span> BDSeBremsstrahlung &amp;right);
00150 
00151      BDSeBremsstrahlung(<span class="keyword">const</span> BDSeBremsstrahlung&amp;);
00152 
00153   <span class="keyword">protected</span>:
00154 
00155      <span class="keyword">virtual</span> G4double SecondaryEnergyThreshold(size_t index);
00156 
00157   <span class="keyword">private</span>:
00158 
00159      G4PhysicsTable* theMeanFreePathTable;
00160 
00161      G4OrderedTable PartialSumSigma;       <span class="comment">// partial sum of total crosssection</span>
00162 
00163      <span class="keyword">static</span> G4double LowerBoundLambda;     <span class="comment">// low  energy limit of crossection table</span>
00164      <span class="keyword">static</span> G4double UpperBoundLambda;     <span class="comment">// high energy limit of crossection table</span>
00165      <span class="keyword">static</span> G4int    NbinLambda;           <span class="comment">// number of bins in the tables</span>
00166 
00167      G4double MinThreshold;                <span class="comment">// minimun value for the production threshold</span>
00168 
00169      G4double LowestKineticEnergy,HighestKineticEnergy; <span class="comment">// bining of the Eloss table</span>
00170      G4int    TotBin;                                   <span class="comment">// (from G4VeEnergyLoss)</span>
00171 
00172      <span class="keyword">static</span> G4double probsup;
00173      <span class="keyword">static</span> G4bool LPMflag;
00174 
00175      <span class="keyword">const</span> std::vector&lt;G4double&gt;* secondaryEnergyCuts;
00176 
00177   <span class="keyword">public</span>:
00178 
00179      <span class="keyword">static</span> <span class="keywordtype">void</span> SetLowerBoundLambda(G4double val);
00180      <span class="keyword">static</span> <span class="keywordtype">void</span> SetUpperBoundLambda(G4double val);
00181      <span class="keyword">static</span> <span class="keywordtype">void</span> SetNbinLambda(G4int n);
00182      <span class="keyword">static</span> G4double GetLowerBoundLambda();
00183      <span class="keyword">static</span> G4double GetUpperBoundLambda();
00184      <span class="keyword">static</span> G4int GetNbinLambda();
00185 
00186      <span class="keyword">static</span> <span class="keywordtype">void</span>   SetLPMflag(G4bool val);
00187      <span class="keyword">static</span> G4bool GetLPMflag();
00188 };
00189 
00190 <span class="comment">//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......</span>
00191 
00192 <span class="preprocessor">#include "BDSeBremsstrahlung.icc"</span>
00193   
00194 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 1 13:36:34 2004 for BDS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
