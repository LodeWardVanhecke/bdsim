<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>BDS: include/myMultipoleField.hh Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">include</a></div>
<h1>myMultipoleField.hh</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">// gab (after NJW)</span>
00002 <span class="preprocessor">#ifndef myMultipoleField_h</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#define myMultipoleField_h 1</span>
00004 <span class="preprocessor"></span>
00005 
00006 <span class="comment">//#include "merlin_config.h"</span>
00007 
00008 <span class="preprocessor">#include &lt;vector&gt;</span>
00009 <span class="preprocessor">#include &lt;utility&gt;</span>
00010 <span class="preprocessor">#include &lt;iostream&gt;</span>
00011 <span class="comment">//#include "NumericalUtils/Complex.h"</span>
00012 <span class="comment">// gab: </span>
00013 <span class="preprocessor">#include&lt;complex&gt;</span>
00014 
00015 <span class="comment">// Space3D</span>
00016 <span class="comment">//#include "EuclideanGeometry/Space3D.h"</span>
00017 <span class="preprocessor">#include"G4ThreeVector.hh"</span>
00018 <span class="preprocessor">#include "globals.hh"</span>
00019 
00020 <span class="comment">// EMFieldRegion</span>
00021 <span class="comment">//#include "AcceleratorModel/EMFieldRegion.h"</span>
00022 
00023 <span class="comment">//      A representation of a multipole expansion of a magnetic</span>
00024 <span class="comment">//      field having only a non-zero component of the magnetic</span>
00025 <span class="comment">//      vector potential in the z-direction. The general</span>
00026 <span class="comment">//      expression for the series is give as</span>
00027 <span class="comment">//</span>
00028 <span class="comment">//                                                               </span>
00029 <span class="comment">//                                              n</span>
00030 <span class="comment">//           By+i Bx =  Sum  B0 (bn-i an) (z/r0)</span>
00031 <span class="comment">//                      n=0</span>
00032 <span class="comment">//</span>
00033 <span class="comment">//      where z=(x+iy). B0 is the overall scale (in Tesla), and</span>
00034 <span class="comment">//      r0 is an aribitrary defining radius. For Multipole</span>
00035 <span class="comment">//      expansions representing ideal single multipoles (e.g.</span>
00036 <span class="comment">//      dipole, quadrupole etc), then B0 is set to the field</span>
00037 <span class="comment">//      strength at r0, and consequently |bn+ i an|=1.</span>
00038 
00039       <span class="keyword">typedef</span> complex&lt;G4double&gt; Complex;
00040       <span class="keyword">typedef</span> G4ThreeVector Vector3D;
00041       <span class="keyword">typedef</span> G4ThreeVector Point3D;
00042 
00043 <span class="keyword">class </span>myMultipoleField 
00044 {
00045   <span class="keyword">public</span>:
00046 
00047       <span class="keyword">typedef</span> std::vector&lt;Complex &gt; TermExpansion;
00048 
00049 
00050    <span class="keyword">typedef</span> TermExpansion::iterator iterator;
00051 
00052    <span class="keyword">typedef</span> TermExpansion::const_iterator const_iterator;
00053 
00054   <span class="keyword">public</span>:
00055       myMultipoleField (G4double scale, size_t nt = 0);
00056       myMultipoleField (<span class="keywordtype">int</span> np, G4double bn, G4double an, G4double r0);
00057 
00058       myMultipoleField (<span class="keywordtype">int</span> np, G4double bn, G4double r0, <span class="keywordtype">bool</span> skew = <span class="keyword">false</span>);
00059       myMultipoleField (<span class="keywordtype">int</span> np, G4double bn, <span class="keywordtype">bool</span> skew = <span class="keyword">false</span>);
00060 
00061 
00062 
00063       <span class="comment">//        Returns the current normalising scale for the field (in</span>
00064       <span class="comment">//        Tesla)</span>
00065       G4double GetFieldScale () <span class="keyword">const</span>;
00066 
00067       <span class="comment">//        Set the (normalising) scale of the field (units are in</span>
00068       <span class="comment">//        Tesla).</span>
00069       <span class="keywordtype">void</span> SetFieldScale (G4double scale);
00070 
00071       <span class="comment">//        Returns true if this field is a null field.</span>
00072       <span class="keywordtype">bool</span> IsNullField () <span class="keyword">const</span>;
00073 
00074       <span class="comment">//        Returns the normalised field component Kn for the</span>
00075       <span class="comment">//        specified magnetic rigidity brho. Kn is defined as</span>
00076       <span class="comment">//        Dn[By+iBx]/brho, where Dn is the n-th complex derivative</span>
00077       <span class="comment">//        wrt x+i y, evaluated at (x+iy)=0. If brho is in</span>
00078       <span class="comment">//        Tesla.meter, Kn has the units 1/meter^(n+1).</span>
00079       Complex GetKn (<span class="keywordtype">int</span> np, G4double rigidity) <span class="keyword">const</span>;
00080 
00081       <span class="comment">//        Returns the 2-D magnetic field in Tesla as the complex</span>
00082       <span class="comment">//        number By+i Bx at the point (x,y) (in meters). The</span>
00083       <span class="comment">//        optional parameter exclude can be used to exclude terms</span>
00084       <span class="comment">//        lower than or equal to exclude Thus a value of exclude=1</span>
00085       <span class="comment">//        gives only that field due to the non-linear terms</span>
00086       <span class="comment">//        (sextupole and above). A Value of -1 (default) includes</span>
00087       <span class="comment">//        all multipole terms.</span>
00088       Complex GetField2D (G4double x, G4double y, <span class="keywordtype">int</span> exclude = -1) <span class="keyword">const</span>;
00089 
00090       <span class="comment">//        Returns the magnetic field at the point x. The time</span>
00091       <span class="comment">//        variable t is ignored.</span>
00092       G4double* GetBFieldAt (<span class="keyword">const</span> G4double* x, 
00093                                            G4double t = 0) <span class="keyword">const</span>;
00094 
00095       <span class="comment">//        Returns a null vector (pure magnetric field).</span>
00096       Vector3D GetEFieldAt (<span class="keyword">const</span> Point3D&amp; x, G4double t = 0) <span class="keyword">const</span>;
00097 
00098       <span class="comment">//        Return the force due to the magnetic field on a particle</span>
00099       <span class="comment">//        of charge q, with position x and velocity v. The time</span>
00100       <span class="comment">//        variable t is ignored (static magnetic field).</span>
00101 
00102         <span class="keyword">virtual</span> Vector3D GetForceAt (<span class="keyword">const</span> Point3D&amp; x, 
00103                     <span class="keyword">const</span> Vector3D&amp; v, G4double q, G4double t = 0) <span class="keyword">const</span>;
00104 
00105   <span class="comment">//            Rotates this field 180 degrees about the local vertical</span>
00106   <span class="comment">//            axis.</span>
00107         <span class="keywordtype">void</span> RotateY180 ();
00108 
00109       <span class="comment">//        Prints an ascii representation (table) of the field to</span>
00110       <span class="comment">//        os.</span>
00111       <span class="keywordtype">void</span> PrintField (std::ostream&amp; os) <span class="keyword">const</span>;
00112 
00113       <span class="comment">//        Add the specified component to the field. The field</span>
00114       <span class="comment">//        components bn and an are in Tesla , and are normalised</span>
00115       <span class="comment">//        to the radius r (default = 1 meter).</span>
00116       <span class="keywordtype">void</span> SetComponent (<span class="keywordtype">int</span> np, G4double bn, G4double an = 0, G4double r0 = 1);
00117 
00118       <span class="comment">//        Returns the field (in Tesla) at the radius r0 due to the</span>
00119       <span class="comment">//        np-th multipole component</span>
00120       Complex GetComponent (<span class="keywordtype">int</span> np, G4double r0 = 1.0) <span class="keyword">const</span>;
00121 
00122       <span class="comment">//        Returns the unitless complex coefficient for the np-th</span>
00123       <span class="comment">//        term (bn+i*an).The coefficient is relative to the</span>
00124       <span class="comment">//        specified pole radius r0 (default = 1meter).</span>
00125       Complex GetCoefficient (<span class="keywordtype">int</span> np, G4double r0 = 1.0) <span class="keyword">const</span>;
00126 
00127       <span class="comment">//        Sets the unitless complex coefficient for the np-th term</span>
00128       <span class="comment">//        (bn+i*an).The coefficient is relative to the specified</span>
00129       <span class="comment">//        pole radius r0 (default = 1meter).</span>
00130       <span class="keywordtype">void</span> SetCoefficient (<span class="keywordtype">int</span> np, <span class="keyword">const</span> Complex&amp; b, G4double r0 = 1.0);
00131 
00132       <span class="keywordtype">int</span> HighestMultipole () <span class="keyword">const</span>;
00133 
00134   <span class="keyword">protected</span>:
00135   <span class="keyword">private</span>:
00136     <span class="comment">// Data Members for Class Attributes</span>
00137 
00138       <span class="comment">//        The scale of the field in Tesla. The coefficients of the</span>
00139       <span class="comment">//        expansion terms are normalised so that they have no</span>
00140       <span class="comment">//        field unit.</span>
00141       G4double B0;
00142       TermExpansion expansion;
00143 
00144   <span class="keyword">private</span>:  
00145 };
00146 
00147 <span class="comment">// Class myMultipoleField </span>
00148 
00149 <span class="keyword">inline</span> myMultipoleField::myMultipoleField (G4double scale, size_t nt)
00150   : B0(scale),expansion(nt,Complex(0,0)){}
00151 
00152 <span class="keyword">inline</span> <span class="keywordtype">bool</span> myMultipoleField::IsNullField ()<span class="keyword"> const</span>
00153 <span class="keyword"></span>{
00154         <span class="keywordflow">return</span> B0==0;
00155 }
00156 
00157 <span class="keyword">inline</span> <span class="keywordtype">int</span> myMultipoleField::HighestMultipole ()<span class="keyword"> const</span>
00158 <span class="keyword"></span>{
00159         <span class="keywordflow">return</span> expansion.size()-1;
00160 }
00161 
00162 
00163 <span class="preprocessor">#endif</span>
00164 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Dec 1 13:36:40 2004 for BDS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
